RewriteEngine On

# Dynamically handle multiple domains
# First domain: https://www.civicbd.com
RewriteCond %{HTTP_HOST} ^www\.civicbd\.com$ [NC]
RewriteRule .* - [E=DOMAIN_ENV:domain1]

# Second domain: https://civicgroupbd.com
RewriteCond %{HTTP_HOST} ^civicgroupbd\.com$ [NC]
RewriteRule .* - [E=DOMAIN_ENV:domain2]

# General rewrite conditions (common to all domains)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Shared Rules (common to all domains)
RewriteRule ^home(/?|)$ index.php?link1=home [QSA]
RewriteRule ^logout(/?|)$ index.php?link1=logout [QSA]
RewriteRule ^login(.*)$ index.php?link1=login [QSA,L]
RewriteRule ^register(/?|)$ index.php?link1=register [QSA,L]
RewriteRule ^setting(/?|)$ index.php?link1=setting [QSA]
RewriteRule ^contact-us(/?|)$ index.php?link1=contact-us [QSA]
RewriteRule ^gallery(/?|)$ index.php?link1=gallery [QSA]
RewriteRule ^request_review(/?|)$ index.php?link1=request_review [QSA]
RewriteRule ^gallery/(.+?)/?$ index.php?link1=gallery&link2=$1 [QSA]
RewriteRule ^about-us/?$ index.php?link1=about-us [QSA]
RewriteRule ^about-us/([^/]+)/?$ index.php?link1=about-us&link2=$1 [QSA]
RewriteRule ^about-us/([^/]+)/([^/]+)/?$ index.php?link1=about-us&link2=$1&link3=$2 [QSA]

# API Rules (shared across all domains)
RewriteRule ^api(/?|)$ api-v2.php [NC,QSA]
RewriteRule ^api/([^\/]+)(\/|)$ api-v2.php?type=$1 [NC,QSA]

# Shared Rule
RewriteRule ^_$ requests.php [QSA]

# Domain 1-specific rules - civicbd.com
RewriteCond %{ENV:DOMAIN_ENV} ^domain1$
RewriteRule ^password-reset/([^\/]+)(\/|)$ index.php?link1=login&link2=password_reset&user_id=$1 [NC,QSA]
RewriteRule ^admin-cp$ admincp.php [NC,QSA]
RewriteRule ^admin-cp/(.*)$ admincp.php?page=$1 [NC,QSA]
RewriteRule ^management$ management.php [NC,QSA]
RewriteRule ^management/(.*)$ management.php?page=$1 [NC,QSA]
RewriteRule ^adminPages/(.*)$ admin-panel/$1 [L]
RewriteRule ^oops$ index.php?link1=oops [NC,QSA]
RewriteRule ^user-activation$ index.php?link1=user-activation [NC,QSA]
RewriteRule ^civic-moonhill(/?|)$ index.php?link1=civic-moonhill [QSA]
RewriteRule ^civic-moonhill/(.+?)/?$ index.php?link1=civic-moonhill&link2=$1 [QSA]
RewriteRule ^civic-moonhill/(.+?)/(.+?)/?$ index.php?link1=civic-moonhill&link2=$1&link3=$2 [QSA]
RewriteRule ^apartments/?$ index.php?link1=apartments [QSA]
RewriteRule ^apartments/(.+?)/?$ index.php?link1=apartments&link2=$1 [QSA]
RewriteRule ^apartments/(.+?)/(.+?)/?$ index.php?link1=apartments&link2=$1&link3=$2 [QSA]

# Domain 2-specific rules - civicgroupbd.com
RewriteCond %{ENV:DOMAIN_ENV} ^domain2$
RewriteRule ^admin-panel$ admin-panel/index.php [NC,QSA]
RewriteRule ^services(/?|)$ index.php?link1=services [QSA]
RewriteRule ^projects(/?|)$ index.php?link1=projects [QSA]
RewriteRule ^projects/(.+?)/?$ index.php?link1=projects&link2=$1 [QSA]
RewriteRule ^contact(/?|)$ index.php?link1=contact [QSA]

# Compression settings
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/html text/css text/javascript text/xml text/plain image/x-icon image/svg+xml application/rss+xml application/javascript application/x-javascript application/xml application/xhtml+xml application/x-font application/x-font-truetype application/x-font-ttf application/x-font-otf application/x-font-opentype application/vnd.ms-fontobject font/ttf font/otf font/opentype
  BrowserMatch ^Mozilla/4 gzip-only-text/html
  BrowserMatch ^Mozilla/4\.0[678] no-gzip
  BrowserMatch \bMSIE !no-gzip !gzip-only-text/html
</IfModule>

# Caching settings
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType application/pdf "access plus 1 month"
  ExpiresByType text/x-javascript "access plus 1 month"
  ExpiresByType application/x-shockwave-flash "access plus 1 month"
  ExpiresByType image/x-icon "access plus 1 year"
  ExpiresDefault "access plus 1 month"
</IfModule>

# Headers
<IfModule mod_headers.c>
  Header unset Connection
  Header set Connection keep-alive
  Header unset Keep-Alive
  Header set Keep-Alive timeout=100,max=500
</IfModule>

# BEGIN cPanel-generated php ini directives, do not edit
# Manual editing of this file may result in unexpected behavior.
# To make changes to this file, use the cPanel MultiPHP INI Editor (Home >> Software >> MultiPHP INI Editor)
# For more information, read our documentation (https://go.cpanel.net/EA4ModifyINI)
<IfModule php8_module>
   php_flag display_errors Off
   php_value max_execution_time 60
   php_value max_input_time 60
   php_value max_input_vars 1000
   php_value memory_limit 512M
   php_value post_max_size 516M
   php_value session.gc_maxlifetime 1440
   php_value session.save_path "/var/cpanel/php/sessions/ea-php82"
   php_value upload_max_filesize 512M
   php_flag zlib.output_compression On
</IfModule>
<IfModule lsapi_module>
   php_flag display_errors Off
   php_value max_execution_time 60
   php_value max_input_time 60
   php_value max_input_vars 1000
   php_value memory_limit 512M
   php_value post_max_size 516M
   php_value session.gc_maxlifetime 1440
   php_value session.save_path "/var/cpanel/php/sessions/ea-php82"
   php_value upload_max_filesize 512M
   php_flag zlib.output_compression On
</IfModule>
# END cPanel-generated php ini directives, do not edit

# php -- BEGIN cPanel-generated handler, do not edit
# Set the “ea-php74” package as the default “PHP” programming language.
<IfModule mime_module>
  AddHandler application/x-httpd-ea-php74 .php .php7 .phtml
</IfModule>
# php -- END cPanel-generated handler, do not edit
